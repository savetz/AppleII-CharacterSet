                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( LOADER                 < 0/ 0/ 0>  1)                                         2 24  THRU                              26 53 THRU                              80 82 THRU                              57 79 THRU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ( STRING COMPARE         < 0/ 0/ 0>  2)                                           ( ADDR1 ADDR2 -- 0/1 )                  : $=                                       OVER C@ OVER C@ =                       IF   1                                  OVER C@ 0                               DO DROP                                 1+ SWAP 1+ SWAP                         OVER C@ OVER C@ =                       IF  1  ELSE  0 LEAVE  THEN              LOOP >R DDROP R>                        ELSE DDROP 0                            THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                    (  0:00)                                                        ( 17:13) ( GET-NUMBER?            < 0/ 0/ 0>  3)                                            : GET-NUMBER?                               0 BEGIN  1+  32 OVER PAD + C!             KEY DUP ASCII 0                         ASCII 9 WITHIN                          WHILE  DUP EMIT                         OVER PAD + C!                           REPEAT DROP  1- PAD C!                  PAD NUMBER DROP [COMPILE]               LITERAL                                 PAD C@ 0= IF DROP                       FALSE ELSE TRUE THEN ;            EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                 -->                                                    ( 17:13) ( CHARACTER SET EDITOR : < 0/ 0/ 0>  4)                                           : EDTASK ;                                                                                                                   40 CONSTANT AMAXX                       48 CONSTANT AMAXY                (  8 ) 20 CONSTANT CMAXX                ( 16 ) 24 CONSTANT CMAXY                        2 CONSTANT CDESC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (  0:00)                                                        ( 17:13) ( CHARACTER SET EDITOR : < 0/ 0/ 0>  5)    VARIABLE CX VARIABLE CY              (  8   CONSTANT DOTSIZE )                  2   CONSTANT XBIG                       2   CONSTANT YBIG                      180  CONSTANT XSMALL1                    1   CONSTANT YSMALL1                  180 CONSTANT XSMALL2                     54 CONSTANT YSMALL2                      EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (  0:00)   -->                                                  ( 17:13) ( DRAW                   <10/ 9/84>146)   CVARIABLE CWID CVARIABLE CHEI           HEX                                     CREATE MSK 80 C, 40 C, 20 C, 10 C,                  8 C, 4 C, 2 C, 1 C,         DECIMAL                                                                       : DRAW ( ADR X , Y )                      CHEI C@ 0 DO                              DDUP 5 PICK I                           CWID C@ * +                             CWID C@ 0 DO                              DUP C@ ?DUP                             IF 8 0 DO                                    MSK I + C@ OVER AND                     IF DOVER CDOT THEN                      4 ROLL 2+ 4 ROLL DSWAP                LOOP DROP                            ELSE ROT 16 + ROT ROT                   THEN 1+                               LOOP DROP DDROP 1+                    LOOP DDROP DROP ;                                                                                                                                                            ( 17:13) ( CHIMAGE                <10/ 9/84>147)                                         CREATE FULBUF 240 ALLOT                                                         : @DOT ( X Y)                                5 * SWAP 8 /MOD ROT + SWAP MSK +        C@ SWAP FULBUF + ;                                                         : @CHIMAGE ( X Y )                           @DOT C@ AND ;                                                              : !CHIMAGE ( X Y )                           @DOT DUP C@ ROT OR SWAP C! ;                                               : 0!CHIMAGE                                  @DOT DUP C@ ROT 255 XOR AND             SWAP C! ;                                                                                                                                                                                                                                                                                                         (  PAI )                                                        ( 17:13) ( CLEAR-IMAGE            < 0/ 0/ 0>  8)                                         : CLEAR-IMAGE                                FULBUF 240 0 FILL ;                EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (  0:00)                                                        ( 17:13) ( CURSE                  < 0/ 0/ 0>  9)                                         VARIABLE VECT                                                                   : -2DOT +CDOT +CDOT ;                   : +2DOT -CDOT -CDOT ;                   : MIDOT CFA VECT !                          CX @ 2* 2* 2 + CY @ 3 * 1+              3 0 DO DDUP OVER 2+                     OVER VECT @ EXECUTE 1+ LOOP             DDROP ;                             : MICUR                                    DDUP OVER 2+ OVER VECT @ EXECUTE ;   : CURSE                                    CX @ CY @ @CHIMAGE  DUP                 IF ' +2DOT ELSE ' -2DOT THEN CFA        VECT ! CX @ 2* 2* 2 + CY @ 3 * 2 +      MICUR QTERM NOT                         IF 10 DELAY THEN                        ROT IF ' -2DOT ELSE ' +2DOT THEN        CFA VECT ! MICUR DDROP ;                                                                                                                            (  0:00)                                                                 (                        < 0/ 0/ 0> 10) : DOTUP ' -2DOT MIDOT ;                 : DOTDWN ' +2DOT MIDOT ;        EXIT     CREATE DOTTAB                            ' 0DOTUP , ' 1DOTUP , ' 2DOTUP ,        ' 3DOTUP , ' 4DOTUP , ' 5DOTUP ,        ' 6DOTUP , ' 7DOTUP ,                  CREATE DOTVASA                          ' 0DOTDOWN , ' 1DOTDOWN , ' 2DOTDOWN ,  ' 3DOTDOWN , ' 4DOTDOWN , ' 5DOTDOWN ,  ' 6DOTDOWN , ' 7DOTDOWN ,                                                       : DOTUP CMAXY 16 > IF ' -2DOT              MIDOT ELSE                              CX @ 2* 2* DOTTAB + @ CFA EXECUTE       THEN ;                               : DOTDWN                                     CMAXY 16 > IF ' +2DOT                   MIDOT ELSE                            CX @ 2* 2* DOTVASA + @ CFA EXECUTE      THEN ;                                                                                                                                             (  0:00)                                                        ( 17:13) ( SMALL-DOT              < 0/ 0/ 0> 11)                                         : SMALL-DOT ( CX CY COLOR -- )                   DDUP  YSMALL1 + SWAP                    XSMALL1 + SWAP CDOT                    YSMALL2 + SWAP                           XSMALL2 + SWAP CDOT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (  0:00)                                                        ( 17:13) ( PUT-DOT  UNPUT-DOT     < 0/ 0/ 0> 12)                                                                                 : PUT-DOT ( -- )                            CX @ CY @ !CHIMAGE                      DOTUP                                   CX @ 2* CY @  SMALL-DOT ;                                                   : -SMALL-DOT                                0 :CDOT C!                              CX @ 2* CY @ SMALL-DOT 1                :CDOT C! ;                                                                  : UNPUT-DOT ( -- )                          CX @ CY @ 0!CHIMAGE                     DOTDWN -SMALL-DOT ;                 EXIT                                                                                                                                                                                                                                                                                                                   (  0:00)                                                        ( 17:13) ( HOME +CX -CX +CY -CY   < 0/ 0/ 0> 13)  : HOME 0 CX ! 0 CY ! ;                  : +CX  1                                     CX +! CX @ CMAXX < NOT                  IF 2BEEP 0 CX !                         CY @ 1+ CMAXY 1- MIN CY ! THEN ;   : -CX -1 CX +! CX @                          0<                                      IF 2BEEP CMAXX 1- CX !                  CY @ 1- 0 MAX CY ! THEN ;          : +CY  1 CY +! CY @ CMAXY                    < NOT                                   IF 2BEEP 0 CY ! CX @ 1+ CMAXX 1         - MIN CX ! THEN ;                  : -CY -1 CY +! CY @ 0<                       IF 2BEEP CMAXY 1- CY ! CX @ 1- 0        MAX CX ! THEN ;                    : +CX+CY +CX +CY ;                      : -CX-CY -CX -CY ;                      : -CX+CY -CX +CY ;                      : +CX-CY +CX -CY ;                                                                                                                                    (  0:00)                                                        ( 17:13) (                        < 0/ 0/ 0> 14) : BOP BEEP DROP ;                       : D-IT IF PUT-DOT ELSE UNPUT-DOT THEN ; : +XDO  CX @ 1+ CMAXX = IF BOP ELSE       D-IT +CX THEN ;                       : +YDO  CY @ 1+ CMAXY = IF BOP ELSE       D-IT +CY THEN ;                       : -XDO                                     CX @ IF D-IT -CX ELSE BOP THEN ;     : -YDO                                     CY @ IF D-IT -CY ELSE BOP THEN ;     : +X+Y                                     CX @ 1+ CMAXX = CY @ 1+                 CMAXY = OR IF BOP ELSE D-IT +CX+CY      THEN ;                               : +X-Y                                     CX @ 1+ CMAXX = CY @ NOT OR IF          BOP ELSE D-IT +CX-CY THEN ;          : -X+Y                                     CX @ NOT CY @ 1+ CMAXY = OR             IF BOP ELSE D-IT -CX+CY THEN ;       : -X-Y CX @ NOT CY @ NOT OR IF BOP         ELSE D-IT -CX-CY THEN ;                                             (  0:00)                                                        ( 17:13) ( TOGGLE-GRID            < 0/ 0/ 0> 15) VARIABLE DO-GRID                        CVARIABLE 1GRID   4 1GRID C!            CVARIABLE 2GRID                                                                 : ?GRID                                    DO-GRID @ ' +CDOT CFA = NOT ;                                                : CLEAN-B-LN                               CMAXY CDESC - 3 * 1+                    CMAXX 2* 1 DO I 2* OVER -CDOT           LOOP ;                                                                       : PUT-BASE-LINE                             CDESC 0> IF                             CLEAN-B-LN                              CMAXX ?GRID NOT IF 2* THEN              0 DO I 2* ?GRID                         IF 2* THEN                              OVER                                    +CDOT LOOP DROP THEN ;                                                                                                                                                                                             ( 17:13) ( PUT-GRID               < 0/ 0/ 0> 16)                                         : PUT-GRID                                 CMAXY OVER                              DO CMAXX                                OVER DO                                 I 2* 2* J 3 * 1+ DO-GRID @ EXECUTE      DUP +LOOP                               DUP +LOOP DROP PUT-BASE-LINE ;                                               : TOGGLE-GRID                              1GRID C@ ?DUP IF DUP                    2GRID C! 0 1GRID C! ' +CDOT ELSE        2GRID C@ DUP 2/ ?DUP NOT IF             4 THEN                                  1GRID C! ' -CDOT THEN CFA               DO-GRID ! PUT-GRID ;                                                                                                                                                                                                                                                                                                                                                                ( 17:13) ( PUT-FRAMES             < 0/ 0/ 0> 17)                                         : SMALL-FRAME                              XSMALL1 2- YSMALL1 1- XSMALL1           CMAXX 2* + YSMALL1 CMAXY +              OP.FR ;                                                                      : PUT-FRAMES                               0 0 CMAXX 2* 2* 2+ CMAXY 3 * 1+         OP.FR SMALL-FRAME PUT-BASE-LINE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( 17:13) ( PUT-MENU               < 0/ 0/ 0> 18)  : HELP-SCREEN TEXT PAGE                ."        MOVE     MOVE     MOVE" CR    ."       CURSOR   CURSOR   CURSOR"      CR                                      ."                & DOT    & CLEAR"     CR                                      ." LEFT     A        F        J" CR     ." RIGHT    D        H        L" CR     ." UP       W        T        O" CR     ." DOWN     X        B        ," CR     ." LE&UP    Q        R        U" CR     ." RI&UP    E        Y        O" CR     ." LE&DWN   Z        V        M" CR     ." RI&DWN   C        N        ." CR CR  ." HOME      P" CR CR                   ." SHIFT-RIGHT ->  SHIFT-LEFT <-" CR    ." SHIFT-UP >       SHIFT-DOWN <" CR CR ." TOGGLE-GRID - SPACE BAR" CR CR       ." TO RETURN - PRESS ANY KEY"               KEY DROP 1HG ;                                                                                                                                                                                                     ( 17:13) ( SHOW-IMAGE             < 0/ 0/ 0> 19)                                            : SHOW-IMAGE PUT-FRAMES                     CMAXY 0 DO                              CMAXX 0 DO  I CX ! J CY !               I J                                     @CHIMAGE                                IF PUT-DOT ELSE                         UNPUT-DOT                               THEN                                    LOOP                                    LOOP                                    PUT-BASE-LINE                           HOME ;                                                                                                                                                                                                                                                                                                                                                                                                                                  (  0:00)                                                        ( 17:13) ( SHIFT-UP-DOWN          < 0/ 0/ 0> 20)                                            : SHIFT-UP                                  CMAXY 1 DO FULBUF I 5 * +               FULBUF I 1- 5 * + 5 BMOVE               LOOP FULBUF CMAXY 1- 5 * +              5 0 FILL SHOW-IMAGE ;               : SHIFT-DOWN                                -1 CMAXY 1- DO FULBUF I 5 * +           FULBUF I 1+ 5 * + 5 BMOVE -1           +LOOP FULBUF 5 0 FILL                    SHOW-IMAGE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ( 17:13) ( SHIFT-RIGHT-LEFT       < 0/ 0/ 0> 21)                                           : SHIFT-RIGHT                              0 CMAXX 1- DO                           CMAXY 0 DO J I                          J 1- I @CHIMAGE IF                      !CHIMAGE ELSE 0!CHIMAGE THEN            LOOP -1 /LOOP                           CMAXY 0 DO  0                           I 0!CHIMAGE LOOP                        SHOW-IMAGE ;                       : SHIFT-LEFT                                 CMAXX 1 DO CMAXY 0 DO                   J 1- I J I @CHIMAGE                     IF !CHIMAGE                             ELSE 0!CHIMAGE                          THEN LOOP LOOP                          CMAXY 0 DO CMAXX 1-                     I 0!CHIMAGE LOOP SHOW-IMAGE ;                                                                                                                                                                                                     (  0:00)                                                        ( 17:13) ( CLEAR-KBD              < 0/ 0/ 0> 22)                                            : CLEAR-KBD                                 BEGIN ?TERMINAL NOT                     UNTIL ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (  0:00)                                                        ( 17:13) ( FIG-EDIT   CONT'D      < 0/ 0/ 0> 23) : +COMMAND                                IF 0 +YDO                               ELSE DUP 63 = IF HELP-SCREEN            ELSE DUP 21 = IF SHIFT-RIGHT            ELSE DUP  8 = IF SHIFT-LEFT             ELSE DUP 62 = IF SHIFT-UP               ELSE DUP 60 = IF SHIFT-DOWN             ELSE BEEP THEN THEN THEN THEN           THEN THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (  0:00)                                                        ( 17:13) ( FIG-EDIT   MAIN LOOP   < 0/ 0/ 0> 24) : FIG-EDIT BEGIN CLEAR-KBD                 BEGIN CURSE QTERM DUP NOT                IF 10 DELAY THEN UNTIL KEY              DUP 27 = NOT WHILE                            DUP 32 = IF TOGGLE-GRID            ELSE DUP 80 ( P) = IF HOME              ELSE DUP 81 ( Q) = IF -CX-CY            ELSE DUP 67 ( C) = IF +CX+CY            ELSE DUP 69 ( E) = IF +CX-CY            ELSE DUP 90 ( Z) = IF -CX+CY            ELSE DUP 65 ( A) = IF -CX               ELSE DUP 68 ( D) = IF +CX               ELSE DUP 87 ( W) = IF -CY               ELSE DUP 88 ( X) = IF +CY               ELSE DUP 82 ( R) = IF 1 -X-Y            ELSE DUP 89 ( Y) = IF 1 +X-Y            ELSE DUP 78 ( N) = IF 1 +X+Y            ELSE DUP 86 ( V) = IF 1 -X+Y            ELSE DUP 70 ( F) = IF 1 -XDO            ELSE DUP 72 ( H) = IF 1 +XDO            ELSE DUP 66 ( B) = IF 1 +YDO            ELSE DUP 84 ( T) = IF 1 -YDO                  -->                 (  0:00)                                                        ( 17:13) ( FIG-EDIT   CONT'D      < 0/ 0/ 0> 25)                                             ELSE DUP 85 ( U) = IF 0 -X-Y            ELSE DUP 79 ( O) = IF 0 +X-Y            ELSE DUP 46 ( .) = IF 0 +X+Y            ELSE DUP 77 ( M) = IF 0 -X+Y            ELSE DUP 74 ( J) = IF 0 -XDO            ELSE DUP 76 ( L) = IF 0 +XDO            ELSE DUP 73 ( I) = IF 0 -YDO            ELSE DUP 44 ( ,) =                      +COMMAND                                THEN THEN THEN THEN THEN THEN THEN      THEN THEN THEN THEN THEN THEN THEN      THEN THEN THEN THEN THEN THEN THEN      THEN THEN THEN THEN DROP              0 21 XYTAB ." X=    Y="                 2 21 XYTAB CX @ . 8 21 XYTAB CY @ .     REPEAT DROP ;                           EXIT                                                                                                                                                                                                                                                                                                 ( 17:13) ( DO-FIG-EDIT            < 0/ 0/ 0> 26)                                         : DO-FIG-EDIT                                   SHOW-IMAGE                              HOME                                    FIG-EDIT ;                                                              : INIT-FIG-EDIT                                 CLEAR-IMAGE                             DO-FIG-EDIT ;                   EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (  0:00)    -->                                                 ( 17:13) ( TEMPFIG                < 0/ 0/ 0> 27)                                                                                  CREATE TEMPFIG ( 128) 243 ALLOT                                                 : CLEAR-TEMP                                                                       TEMPFIG  3 + 240 0 FILL ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ( 17:13) (                        < 0/ 0/ 0> 28)  CVARIABLE TOPOF                         CVARIABLE BITWID                        : !C-WIDTH ( N -- ) TEMPFIG C! ;        : @C-WIDTH ( -- )                           TEMPFIG C@ ;                        : !C-HEIGHT ( N -- ) TEMPFIG 1+ C! ;    : @C-HEIGHT ( -- N )                        TEMPFIG 1+ C@ ;                                                             : !TOPOF ( N -)                             TEMPFIG 2+ C! ;                     : @TOPOF ( - )                              TEMPFIG 2+ C@ ;                                                            : LASTBIT 0 BITWID C!                      CMAXY 0 DO I 5 * CWID C@ + 1-           FULBUF + C@ BITWID DUP C@ ROT OR        SWAP C! LOOP ;                                                                                                                                                                                                                      (  0:00)                                                        ( 17:13) ( GET-C-SIZE            < 0/ 0/ 0> 29)    : GET-WID LASTBIT BITWID C@                8 0 DO DUP 1 AND 1 =                    IF DROP I LEAVE ELSE                    2/ THEN LOOP 8 SWAP - ;              : GET-C-SIZE   ( -- N )                     50 TOPOF C! 0 CHEI C!                  0 5 0 DO                                CMAXY 0 DO                              I 5 * J + FULBUF + C@                   IF TOPOF                                DUP C@ I MIN SWAP C! DROP               J LEAVE THEN LOOP                       -1 CMAXY 1- DO                          I 5 * J + FULBUF + C@                   IF CHEI DUP C@ I 1+ MAX SWAP C!         LEAVE THEN                              -1 +LOOP LOOP TOPOF C@ 50 = IF          DROP ELSE DUP 1+                        CWID C! 2* 2* 2*                        GET-WID + !C-WIDTH                      CHEI C@ TOPOF C@ DUP !TOPOF -           DUP !C-HEIGHT CHEI C! THEN ;                                      (  0:00)                                                        ( 17:13) ( BYTES->PIXELS          < 0/ 0/ 0> 30)                                          : BYTES->PIXELS                             CLEAR-TEMP  GET-C-SIZE                  @C-HEIGHT 0 DO                          FULBUF I TOPOF C@ + 5 * +               TEMPFIG I CWID C@ * + 3 +               CWID C@ BMOVE LOOP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (  0:00)                                                        ( 17:13) ( PIXELS->BYTES          < 0/ 0/ 0> 31)                                          : PIXELS->BYTES                             CLEAR-IMAGE                             @TOPOF 5 *                              @C-WIDTH 7 + 2/ 2/ 2/                   @C-HEIGHT 0 DO                          TEMPFIG 3 + OVER I * +                  FULBUF 4 PICK + I 5 * +                 3 PICK BMOVE LOOP DDROP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (  0:00)                                                        ( 17:13) ( ASCII-TABLE            < 0/ 0/ 0> 32) 1024  CONSTANT 1K                         1K 4 *       CONSTANT 4K                4K 270 - CONSTANT MAX-TAB               CREATE    ASCTAB   4K ALLOT             VARIABLE NEXT-TAB                       ASCTAB 270 + CONSTANT CHDATA          EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( 17:13) ( INIT-ASCII-TABLE       < 0/ 0/ 0> 33)                                          : INIT-ASCII-TABLE                          0 CHDATA !  0 CHDATA 2+ !               ASCTAB 270 0 FILL                       4 DUP NEXT-TAB ! ASCTAB 256 + ! ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (  0:00)                                                        ( 17:13) ( ADDC    ADD CHAR TO ASC< 0/ 0/ 0> 34)                                          : ADDC                                      2* ASCTAB + NEXT-TAB @ SWAP !           @C-WIDTH 7 + 2/ 2/ 2/                    @C-HEIGHT * DUP IF 3 +                  DUP NEXT-TAB @ +                        MAX-TAB <                               IF                                      TEMPFIG                                 CHDATA NEXT-TAB @ +                     ROT DUP NEXT-TAB +!                     NEXT-TAB @ ASCTAB 256 + !               BMOVE 1                                 ELSE DROP 0 THEN THEN ;                                                                                                                                                                                                                                                                                                                                                                          (  0:00)                                                        ( 17:13) ( COMPRESS-ASCII-TABLE   < 0/ 0/ 0> 35)                                          : COMPRESS-ASCII-TABLE                      ASCTAB PAD 4K BMOVE                     INIT-ASCII-TABLE                         128 0 DO                                I   2*  PAD + @                         ?DUP IF                                 CHDATA + ASCTAB -                       PAD +                                   TEMPFIG                                 OVER DUP 1+ C@ SWAP C@ 7 + 8 /          * 3 + BMOVE                             I ADDC DROP                             THEN LOOP ;                                                                                                                                                                                                                                                                                                                                                                                      (  0:00)                                                        ( 17:13) ( GPUTC CONSTANTS        < 0/ 0/ 0> 36)                                           0 CONSTANT LMARGIN                      279 CONSTANT RMARGIN                    0 CONSTANT TMARGIN                                                              159 CONSTANT BMARGIN                                                                                                    4 CONSTANT DX                           4 CONSTANT DY                           VARIABLE   GX                           VARIABLE   GY                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (  0:00)                                                        ( 17:13) ( GPUTC                  < 0/ 0/ 0> 37)                                           : GPUTC                                    2*   ASCTAB + @                         DUP                                     IF   CHDATA +                           DUP C@ DUP 7 + 2/ 2/ 2/ CWID C!         2* GX @ + RMARGIN >                     IF   LMARGIN GX ! CMAXY DY + GY +!      THEN                                    DUP 1+ C@ CHEI C!                       DUP  3 + GX @ OVER 1- C@ GY @ +         DRAW C@ 2* DX + GX +!                   ELSE DROP                               THEN ;                                EXIT                                                                                                                                                                                                                                                                                                                                                        (  0:00)   -->                                                           ( GTYPEALL               < 0/ 0/ 0> 38)                                         : <ESC> 0 22 XYTAB                          ." PRESS <ESC> TO RETURN" ;                                                 : GETESC <ESC>                              BEGIN KEY 27 = UNTIL ;                                                       : GTYPEALL                                  HGR 1HG                               LMARGIN                                 GX ! TMARGIN 24 MAX GY !                128 0 DO I GPUTC LOOP                   GETESC ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( 17:13) ( GECHO                  < 0/ 0/ 0> 39)                                           : GECHO PAGE                             HGR 1HG <ESC>                           LMARGIN GX ! TMARGIN ( 24 MAX) GY !     BEGIN  KEY                              DUP 27 = NOT                            WHILE  GPUTC                            REPEAT DROP TEXT ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (  0:00)                                                        ( 17:13) (                        < 0/ 0/ 0> 40)                                            : >BLK                                       DUP @                                   OVER 4 + @ *                           6 +                                     + ;                                                                         : +BLK                                      1 OVER 4 + +!                           DUP 2+ @                                OVER 4 + @                              > IF DROP ELSE 0 SWAP 4 + !             THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                  (  0:00)                                                        ( 17:13) ( RING BUFFER PRIMITIVES < 0/ 0/ 0> 41)                                            : -BLK     -1 OVER 4 + +!                    -1 OVER 4 + +!                          DUP 4 + @  0<                           IF DUP 2+ @ SWAP 4 + !                  ELSE DROP THEN ;                                                           : !BLK#                                      DDUP                                    2+ @ >                                  IF DDROP ELSE 4 + !                     THEN ;                                                                     : @BLK#                                      4 + @ ;                                                                                                                                                                                                                                                                                                                                                                                                                ( 17:13) ( RING BUFFER PRIMITIVES < 0/ 0/ 0> 42)                                           : @MAX-BLK# 2+ @ ;                                                                                                      : !MAX-BLK#   2 + ! ;                   : +MAX-BLK#   2+  +! ;                                                                                                  : >BLKN       SWAP OVER @ * +                         6 + ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (  0:00)                                                        ( 17:13) ( DIRECTORY:  CREATE     < 0/ 0/ 0> 43)                                           CREATE NAME-BUFFER  13 ALLOT                                                    1             CONSTANT NDBLOCS          1K            CONSTANT DIR-SIZE         19            CONSTANT ENTRY-SIZE       52            CONSTANT MAX-FONTS                                                CREATE FONT-DIRECTORY                    DIR-SIZE ALLOT                                                                 FONT-DIRECTORY                          4 +  CONSTANT  FONT-LIST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ( 17:13) ( FIG-LIST:   ACCESS OPER< 0/ 0/ 0> 44)                                            : ^ENTRYN  FONT-LIST >BLKN ;            : ^ENTRY   FONT-LIST >BLK ;             : ^NAME    ^ENTRY 0 + ;                 : ^BLOCK#  ^ENTRY 13 + ;                : ^OFFSET  ^ENTRY 15 + ;                : ^SIZE    ^ENTRY 1 7 + ;               : !FONT#   FONT-LIST !BLK# ;            : @FONT#   FONT-LIST  @BLK# ;           : +FONT    FONT-LIST +BLK ;             : !NFONTS  FONT-LIST !MAX-BLK# ;        : @NFONTS  FONT-LIST @MAX-BLK# ;        : +NFONTS  @NFONTS                                 1+ @FONT# MAX  !NFONTS ;       EXIT                                                                                                                                                                                                                                                                                                                                                               -->                                                    ( 17:13) ( FIG-LIST:   FIND-BLOCK < 0/ 0/ 0> 45)    : FIND-BLOCK                               0 !FONT#                                BEGIN    +FONT                          ^NAME C@                                127 AND 0=                              @FONT#   0= OR                          UNTIL                                   @FONT# 0=   @NFONTS MAX-FONTS           < AND                                   IF @NFONTS !FONT#                       0 ^NAME C!                              +NFONTS                                 THEN @FONT# ;                          EXIT                                                                                                                                                                                                                                                                                                                                                                                              (  0:00) -->                                                    ( 17:13) ( FIG-LIST:   FIND-NAME  < 0/ 0/ 0> 46)                                                                                   : FIND-NAME                                 0 !FONT#                                BEGIN  +FONT                             NAME-BUFFER                             ^NAME  $=                               @FONT# 0=  OR                           UNTIL                                   @FONT# ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ( 17:13) ( FIG-LIST:   !NAME  STOR< 0/ 0/ 0> 47)                                            : !NAME                                     NAME-BUFFER ^NAME  13 CMOVE ;                                                                                       : .NAME ^NAME COUNT TYPE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (  0:00)                                                        ( 17:13) ( FIG-LIST:   NEW-ENTRY  < 0/ 0/ 0> 48)                                            : NEW-ENTRY  ( --     )                     FIND-BLOCK                               IF                                      !NAME                                   THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (  0:00)                                                        ( 17:13) ( INIT-FONT-DIRECTORY    < 0/ 0/ 0> 49)  : INIT-FONT-DIRECTORY                       FONT-DIRECTORY DIR-SIZE 0 FILL          ENTRY-SIZE FONT-LIST                    0 + !                                   1 FONT-LIST  2 + !                      0 FONT-LIST 4 + ! ;                                                                                                    INIT-FONT-DIRECTORY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (  0:00)                                                        ( 17:13) ( DIRECTORY:  PUT-DIRECTO< 0/ 0/ 0> 50)                                                                                 : PUT-DIRECTORY                            FONT-DIRECTORY 0 BLOCK 1K BMOVE         UPDATE FLUSH ;                                                                                                       : GET-DIRECTORY                            INIT-FONT-DIRECTORY                     0 BLOCK FONT-DIRECTORY 1K BMOVE ;    EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (  0:00)   -->                                                  ( 17:13) (                        < 0/ 0/ 0> 51)                                         : CH-HELP-SCR                              TEXT PAGE                            ."   CHANGING FRAME SIZE" CR CR CR      ."  D  INCREASE WIDTH" CR CR            ."  A  DECREASE WIDTH" CR CR            ."  X  INCREASE HEIGHT" CR CR           ."  W  DECREASE HEIGHT" CR CR CR        ."   MOVE BASE-LINE" CR CR CR           ."  R   UP      " CR CR                 ."  V   DOWN    "  CR CR                ." TO RETURN - PRESS ANY KEY"            KEY DROP 1HG ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( 17:13) ( CHR-EDIT               < 0/ 0/ 0> 52)   VARIABLE #N   VARIABLE NN                                                      : CHR-EDIT                                  INIT-FIG-EDIT                           BYTES->PIXELS ;                    EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (  0:00)                                                        ( 17:13) ( LIST-AVAIL-FONTS       < 0/ 0/ 0> 53)   CVARIABLE FOUND                        : LIST-AVAIL-FONTS  GET-DIRECTORY           PAGE TEXT 0 0 XYTAB                ." KNOWN FONTS (THERE MAY BE OTHERS): "    CR                                        0 !FONT# 0 FOUND C!                     BEGIN  +FONT                            @FONT# 0>                               WHILE  ^NAME C@ 0>                      IF CR 3 SPACES .NAME 1 FOUND C!         THEN  REPEAT  CR CR                     FOUND C@ NOT IF ." DISK EMPTY"         THEN ;                                                                      : .DIR LIST-AVAIL-FONTS ;               EXIT                                                                                                                                                                                                                                                                                                                              -->                                                  ( 17:13) ( SPECIFY-ASCENDER       < 0/ 0/ 0> 54) EXIT                                    : GET-NUM                                  BEGIN                                    GET-NUMBER?                              IF   DUP  4 PICK 4 PICK WITHIN          IF   1                                  ELSE BEEP CR                            ." OUT OF BOUNDS: "                     . 0 THEN                                ELSE BEEP 0 THEN                        UNTIL ROT ROT DDROP ;              : SPECIFY-ASCENDER                          CR                                  ." SPECIFY HEIGHT ABOVE BASE LINE: "        1 AMAXY GET-NUM ;                   EXIT                                                                                                                                                                                                                                                                                                                   (  0:00)                                                        ( 17:13) ( SPECIFY-DESCENDER      < 0/ 0/ 0> 55) EXIT                                      : SPECIFY-DESCENDER                       CR                                     ." SPECIFY DESCENDER: "                    0 AMAXY GET-NUM ;                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (  0:00)                                                        ( 17:13) ( GET-FONT-HEIGHT        < 0/ 0/ 0> 56) EXIT                                      : GET-FONT-HEIGHT                         BEGIN CR CR                         ." DEFINE FONT HEIGHT (UP TO 48 TOTAL)" CR                                           SPECIFY-DESCENDER 5 DELAY               SPECIFY-ASCENDER  5 DELAY               OVER OVER + 1 AMAXY WITHIN NOT          WHILE  BEEP CR                          ." FONT HEIGHT OUT OF BOUNDS: " + .     REPEAT OVER                             DUP ' CDESC !                           + ' CMAXY ! CR                      ." SPECIFY MAX WIDTH (UP TO 40): "         1 AMAXX GET-NUM                         ' CMAXX ! ;                         EXIT                                                                                                                                                                                                                                                                           (  0:00)                                                        ( 17:13) ( NO-FONT                < 0/ 0/ 0> 57)                                          : NO-ROOM                                 CR ." THERE IS NO MORE ROOM ON THIS  DISK " CR                                  ." PLEASE USE ANOTHER ONE "             40 DELAY ;                                                                   : NEW-FONT                              ( 0 !FONT# )                                FIND-BLOCK                              IF   !NAME CR                           ." ADDED FONT " .NAME                   ."  TO DIRECTORY."                      ELSE CR                             ." DIRECTORY FULL, CANNOT ADD FONT "      .NAME <ABORT>                            THEN ;                                                                                                                                                                                                                                                                      (  0:00)                                                        ( 17:13) ( NAME-BUFFER   HANDLE-B\< 0/ 0/ 0> 58) ( KSP                                 ) ( CREATE NAME-BUFFER 13 ALLOT )                                                 : HANDLE-BKSP ( LENGTH 8 -- LENGTH' )      DROP                                    DUP 0>                                  IF 32 OVER NAME-BUFFER + C!                8 EMIT 32 EMIT 8 EMIT                   1- ( LENGTH' )                       ELSE BEEP                               THEN ;                               EXIT                                                                ( 13:54)                                                                                                                                                                                                                                                                                                                                                                                                           (  0:00)                                                                 ( READ-NAME              < 0/ 0/ 0> 59)                                          : READ-NAME NAME-BUFFER 13 32 FILL          0 BEGIN KEY                             DUP   13 = NOT                          WHILE                                   DUP  8 = IF HANDLE-BKSP ELSE            DUP   33 < IF DROP BEEP                 ELSE                                    DUP  127 > IF DROP BEEP   ELSE          OVER  11 > IF DROP BEEP                 ELSE  ( TOO LONG )                      SWAP 1+ SWAP DUP EMIT                   OVER NAME-BUFFER + C!                   THEN THEN THEN THEN                     REPEAT DROP CR                          NAME-BUFFER C! ;                   EXIT                                                                                                                                                                                                                                                                           (  0:00)                                                        ( 17:13) ( SPECIFY-FONT           < 0/ 0/ 0> 60) : GET-NAME 0 22 XYTAB                      ." SPECIFY FONT: " CR                   READ-NAME NAME-BUFFER C@ 0=             IF CR ." NO NAME GIVEN" 0               ELSE 1 THEN ;                                                                : F-GET-NAME                               GET-NAME IF FIND-NAME IF 1 EXIT         THEN THEN 0 ;                                                                : SAVE-PARM                                ASCTAB 256 + NEXT-TAB @ OVER ! 2+       CMAXY OVER ! 2+                         CDESC OVER ! 2+ DUP @                   CMAXX MAX SWAP ! ;                                                           : GET-PARM                                 ASCTAB 256 + DUP @ NEXT-TAB ! 2+        DUP @ ' CMAXY ! 2+                      DUP @ ' CDESC ! 2+ @ ' CMAXX ! ;                                             EXIT                                                                   (  0:00)   -->                                                  ( 17:13) ( GET-FONT               < 0/ 0/ 0> 61) CVARIABLE JUSTAFTER                     CVARIABLE REDEFINED                     20 CONSTANT CMADX                       24 CONSTANT CMADY                        : GET-FONT                                 GET-DIRECTORY .DIR 0 REDEFINED C!       F-GET-NAME                              IF @FONT#                               4 0 DO  DUP I + BLOCK                   I 1K * ASCTAB + 1K BMOVE                LOOP DROP GET-PARM                      ELSE INIT-ASCII-TABLE ( GET-NAME )      CMADX ' CMAXX !                         CMADY ' CMAXY !                         GET-FONT-HEIGHT 1 JUSTAFTER C!          NEW-FONT                                PAGE THEN ;                                                                                                                                                                                                                                                                                                                                ( 17:13) ( SAVE-FONT              < 0/ 0/ 0> 62)                                           : SAVE-FONT                                GET-DIRECTORY                           F-GET-NAME NOT IF NEW-FONT THEN         @FONT# 132 >                            IF NO-ROOM EXIT ( ELSE  !NAME )         THEN REDEFINED C@ IF                    COMPRESS-ASCII-TABLE                    0 REDEFINED C! THEN                     SAVE-PARM                               @FONT# 4 0 DO I 1K * ASCTAB +           OVER I + BLOCK UPDATE                   1K BMOVE                                LOOP FLUSH DROP                          ." ** SAVED **" ;                                                                                                                                                                                                                                                                                                                                        (  0:00)                                                        ( 17:13) ( CSHOW                  < 0/ 0/ 0> 63)                                          : CSHOW ( N -- )                            DUP  0 = IF ." ^2" ELSE                 DUP 27 = IF ." ^                        [" ELSE                                 DUP 28 = IF ." ^\" ELSE                 DUP 29 =                                IF ." ^]" ELSE                          DUP 30 = IF ." ^6" ELSE                 DUP 31 = IF ." ^-" ELSE                 DUP 1 26 WITHIN                         IF                                      ." ^" DUP ASCII A +                     1- EMIT ELSE                            SPACE DUP EMIT                          THEN THEN THEN THEN THEN                THEN THEN                          ."  ("   ( N ) 3 .R   ." )  " ;         EXIT                                                                                                                                                                                                    -->                                                    ( 17:13) ( GET-FONT               < 0/ 0/ 0> 64)                                         : ?CHANGE-WIDTH                               5 21 XYTAB                        ." DO YOU WANT TO CHANGE WIDTH OR"         5 22 XYTAB                           ." DESCENDER OF THE FRAME" (Y/N)?          IF 1 NOTHEICH C!                        GET-FONT-HEIGHT HGR 1HG                 PUT-FRAMES                              0 NOTHEICH C! THEN CR CR CR CR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ( 17:13) ( LIST-DEFINED-CHARACTERS< 0/ 0/ 0> 65)                                            : LIST-DEFINED-CHARACTERS                  128 0 DO   I 2* ASCTAB + @              IF   I CSHOW  ELSE 10 SPACES            THEN LOOP GETESC ;                     EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (  0:00)                                                        ( 17:13) ( RESUME-CHR-EDIT        < 0/ 0/ 0> 66)   VARIABLE  CURRENT-CHAR                  VARIABLE  PREVIOUS-CHAR-PTR             VARIABLE  CHAR-SAVED?                   VARIABLE  FONT-SAVED?                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -->                                                  ( 17:13) ( DO-SAVE-CURRENT-CHAR   < 0/ 0/ 0> 67) CVARIABLE NEWCH                         : SAVE-CURRENT-CHAR                        CHAR-SAVED? @ IF EXIT THEN              BYTES->PIXELS NEWCH C@                  IF CR ." SPECIFY NEW CHARACTER: "       KEY DUP EMIT CURRENT-CHAR !             THEN CURRENT-CHAR @                     DUP 2* ASCTAB + @ IF 1 REDEFINED        C! THEN ADDC                            IF   TRUE CHAR-SAVED? !                 FALSE FONT-SAVED? ! THEN ;           : DO-SAVE-CURRENT-CHAR                     CURRENT-CHAR @ 0<                       IF ." NO CURRENT CHARACTER "            ELSE  CURRENT-CHAR @ CSHOW              SAVE-CURRENT-CHAR ."   SAVED "          THEN 20 DELAY ;                      : SAVE-AS-NEW                              1 NEWCH C! PAGE DO-SAVE-CURRENT-CHAR    0 NEWCH C! ;                         EXIT                                                                                                                      -->                                                  ( 17:13) ( DEFINE-BLANK           < 0/ 0/ 0> 68) : DEFINE-BLANK                             32 CURRENT-CHAR !                       CR CR ." WIDTH OF BLANK CHARACTER: "    ?DUP IF  .                              CR CR ." CHANGE? " (Y/N)?               IF CR CR ." WIDTH: "                    ELSE EXIT THEN                          THEN                                    GET-NUMBER?                             IF   TEMPFIG 242 0 FILL                 TEMPFIG C!  CMAXY TEMPFIG 1+ C!         32 ADDC                                 IF TRUE CHAR-SAVED? ! FALSE             FONT-SAVED? ! THEN                      ELSE CR CR ." NO CHANGE ..."            100 DELAY THEN ;                     EXIT                                                                                                                                                                                                                                                                           (  0:00)   -->                                                  ( 17:13) ( EDIT-NEW-CHAR          < 0/ 0/ 0> 69)   : EDIT-NEW-CHAR PAGE                       CHAR-SAVED? @ NOT IF CR CR         ." CURRENT CHAR NOT SAVED, TRY AGAIN"        TRUE CHAR-SAVED? ! 10 DELAY             ELSE CR CR                              ." SPECIFY CHARACTER:  " KEY            DUP 13 = IF DROP                        CR ." NO CHARACTER SPECIFIED ... "      10 DELAY ELSE DUP                       32 = IF ( 32 ) CSHOW DEFINE-BLANK       ELSE HGR 1HG PUT-FRAMES                  DUP CSHOW DUP 2* ASCTAB + @            ?DUP IF CHDATA + TEMPFIG 243 BMOVE      PIXELS->BYTES SHOW-IMAGE                ELSE CLEAR-IMAGE                        TEMPFIG 3 0 FILL JUSTAFTER C@ NOT       IF ?CHANGE-WIDTH ELSE                   0 JUSTAFTER C! THEN                     THEN CURRENT-CHAR ! 10 DELAY            HOME FIG-EDIT TEXT                      FALSE CHAR-SAVED? !                     THEN THEN THEN ;                                                                                                                  ( 17:13) ( DO-TYPE-ALL            < 0/ 0/ 0> 70)   : DO-TYPE-ALL  PAGE                        CURRENT-CHAR @ 0<                       IF GTYPEALL                             ELSE  CURRENT-CHAR @ 2*                 ASCTAB + @  >R                          NEXT-TAB @ >R                           SAVE-CURRENT-CHAR                       GTYPEALL R>                             NEXT-TAB !                              R> CURRENT-CHAR @ 2* ASCTAB + !         THEN TEXT ;                        EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (  0:00)                                                        ( 17:13) ( DO-SAVE-FONT           < 0/ 0/ 0> 71)                                         : DO-SAVE-FONT                             CHAR-SAVED? @                           IF LIST-AVAIL-FONTS                     CR                                      SAVE-FONT                               PUT-DIRECTORY                           TRUE FONT-SAVED? ! ELSE              ." CURRENT CHAR NOT SAVED, TRY AGAIN"      TRUE CHAR-SAVED? !                      100 DELAY                               THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (  0:00)                                                        ( 17:13) ( DO-GET-FONT            < 0/ 0/ 0> 72)  : DO-GET-FONT                              FONT-SAVED? @ NOT                       IF CR                               ." CURRENT FONT NOT SAVED, TRY AGAIN"      TRUE                                     FONT-SAVED? ! 100 DELAY                 ELSE CHAR-SAVED? @ NOT                  IF CR                               ." CURRENT CHAR NOT SAVED, TRY AGAIN"       TRUE                                    CHAR-SAVED? !                           100 DELAY                               ELSE                                    GET-FONT                                THEN THEN ;                            EXIT                                                                                                                                                                                                                                                                                                                (  0:00)   -->                                                  ( 17:13) ( DO-LIST-AVAIL-FONTS    < 0/ 0/ 0> 73)                                            : DO-LIST-AVAIL-FONTS                      LIST-AVAIL-FONTS                        GETESC ;                          EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (  0:00)                                                        ( 17:13) ( MAIN-TABLE             < 0/ 0/ 0> 74) : DO-INIT-DISK                             INIT-FONT-DIRECTORY PUT-DIRECTORY ;                                            CREATE MAIN-TABLE                        ' DO-GET-FONT CFA ,                     ' EDIT-NEW-CHAR CFA ,                   ' SAVE-CURRENT-CHAR CFA ,               ' SAVE-AS-NEW CFA ,                     ' DO-SAVE-FONT CFA ,                    ' LIST-DEFINED-CHARACTERS CFA ,         ' DO-TYPE-ALL CFA ,                     ' GECHO   CFA ,                         ' DO-LIST-AVAIL-FONTS CFA ,             ' DO-INIT-DISK CFA ,                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                                           ( 17:13) ( .PERCENT               < 0/ 0/ 0> 75)                                            : .PERCENT  ( N1 N2 -- )                    OVER .                                  ." / "                                  DUP .                                   ." ( "                                  SWAP 100 M* 3 PICK M/                   3 .R                                    ." ."                                   100 ROT */ .                            ." % )" ;                        EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (  0:00)   -->                                                  ( 17:13) ( PUT-STATUS             < 0/ 0/ 0> 76)                                         : NOTS IF ."    NOT SAVED" THEN CR ;                                            : PUT-STATUS                                  ." CURRENT FONT : " NAME-BUFFER         COUNT DUP 32 = IF DDROP                ." (NONE)" ELSE TYPE THEN                FONT-SAVED?                             @ NOT NOTS                              ." CURRENT CHAR : "                     CURRENT-CHAR @ DUP 0 >                  IF    CSHOW                             CHAR-SAVED? @ NOT NOTS ELSE             DROP ." (NONE)" CR THEN                 ." BUFFER USAGE : "                     NEXT-TAB @ 4 - MAX-TAB 4 -              .PERCENT CR CR ;                  EXIT                                                                                                                                                                                                                                              -->                                                  ( 17:13) ( PUT-MAIN-MENU          < 0/ 0/ 0> 77)    : PUT-MAIN-MENU                      ." MAIN MENU: "                               CR CR                             ." 0  GET FONT" CR                      ." 1  EDIT CHARACTER" CR                ." 2  SAVE CURRENT CHARACTER" CR        ." 3  SAVE AS NEW" CR                   ." 4  SAVE CURRENT FONT" CR             ." 5  LIST DEFINED CHARACTERS" CR       ." 6  PRINT ALL CHARACTERS"  CR         ." 7  ECHO TYPED CHARACTERS" CR         ." 8  LIST AVAILABLE FONTS" CR          ." 9  INITIALIZE DISK" CR CR            ." <ESC> TO END EDITING" CR CR          ." SELECT ANY CORRESPONDING NUMBER" CR  ;                                       EXIT                                                                                                                                                                                                                                                                                                                                           ( 17:13) ( DO-MAIN-MENU           < 0/ 0/ 0> 78) : DO-MAIN-MENU                               BEGIN                                    PUT-STATUS PUT-MAIN-MENU                KEY DUP 27 =                            IF DROP 1                               ELSE DUP 48 57  WITHIN                  IF 48 - 2*                              MAIN-TABLE + @ EXECUTE PAGE 0           ELSE DROP 0 BEEP                        THEN THEN                              UNTIL ;                                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (  0:00)   -->                                                  ( 17:13) ( START                  < 0/ 0/ 0> 79)                                            : START INIT-ASCII-TABLE                   0 NOTHEICH C!                           0 JUSTAFTER C!                          EMPTY-BUFFERS PAGE TEXT                 4 1GRID C!                              0 NAME-BUFFER C!                        4 NEXT-TAB !                            NAME-BUFFER 13 32 FILL                  -1 CURRENT-CHAR !                       TRUE CHAR-SAVED? !                      TRUE FONT-SAVED? !                      8 10 XYTAB                              ." CHARACTER SET EDITOR"                 30 DELAY  PAGE                         1 10 XYTAB                        ." PLEASE INSERT FONT-DISK IN DRIVE A"        9 12 XYTAB                        ." AND PRESS ANY KEY"                         KEY DROP PAGE                           DO-MAIN-MENU ;                    EXIT                                                                                                                                   ( 17:13) (                        < 0/ 0/ 0> 80)                                         : ERASE-VERT                               CMAXY 2+ 0 DO XSMALL1 CMAXX 2* + I      -CDOT XSMALL1 2- I -CDOT LOOP ;                                              : ERASE-HOR XSMALL1 CMAXX 2* +              XSMALL1 DO I YSMALL1 CMAXY             +  -CDOT I YSMALL1 1-  -CDOT 2          +LOOP ;                                                                      : ERASE-B-LINE                             CMAXX 2* XSMALL1 + XSMALL1 DO           I CMAXY CDESC - YSMALL1 + -CDOT         4 +LOOP ;                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( 17:13) (                        < 0/ 0/ 0> 81) CVARIABLE NOTHEICH                      : ERASE-FRAME ERASE-VERT ERASE-HOR ;    : PLOT-B-LINE                               CMAXX 2* XSMALL1 + XSMALL1 DO           I CMAXY CDESC - YSMALL1 + +CDOT         4 +LOOP ;                           : PUT-B-LINE ERASE-B-LINE                   ' CDESC +! CDESC DUP 2 <                IF BEEP 2 ' CDESC ! THEN                CMAXY = IF BEEP CMAXY 1- ' CDESC !      THEN PLOT-B-LINE ;                  : PUTERHOR                                  ERASE-FRAME ' CMAXX +! CMAXX            DUP 40 > IF BEEP 40 ' CMAXX ! THEN      4 < IF BEEP 4 ' CMAXX ! THEN            SMALL-FRAME PLOT-B-LINE ;           : PUTERVER  NOTHEICH C@  IF BEEP DROP       ELSE ERASE-B-LINE                       ERASE-FRAME ' CMAXY +! CMAXY            DUP 48 > IF BEEP 48 ' CMAXY ! THEN      4 < IF BEEP 4 ' CMAXY ! THEN            SMALL-FRAME PLOT-B-LINE THEN ;                                                                                                     ( 17:13) (                        < 0/ 0/ 0> 82)   1 NOTHEICH C!                                                                 : COORD                                     1 21 XYTAB ." DESCENDER =" CDESC .     16 21 XYTAB ." WIDTH =" CMAXX .         27 21 XYTAB ." HEIGHT =" CMAXY . ;                                           : GET-FONT-HEIGHT                          PAGE HGR 1HG                            COORD                                   SMALL-FRAME                             BEGIN                                   KEY DUP 87 =                            IF -1 PUTERVER   ELSE DUP 88 =          IF 1 PUTERVER    ELSE DUP 65 =          IF -1 PUTERHOR   ELSE DUP 68 =          IF 1 PUTERHOR    ELSE DUP 82 =          IF 1 PUT-B-LINE  ELSE DUP 86 =          IF -1 PUT-B-LINE ELSE DUP 63 =          IF CH-HELP-SCR THEN                     THEN THEN THEN THEN THEN THEN           COORD                                   27 = UNTIL TEXT ;                                                                           ( 17:13) ( PUT-FRAMES             < 0/ 0/ 0> 82) : PUT-FRAMES                               0 0 CMAXX 2* 2* 2+ CMAXY 3 * 1+         OP.FR SMALL-FRAME PUT-BASE-LINE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ( 17:13)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( PUT-FRAMES             < 0/ 0/ 0> 82) CVARIABLE NO-HEICH 1 NO-HEICH C!                                                : GET-FONT-HEIGHT                          PAGE HGR 1HG                             1 21 XYTAB ." DESCENDER =" CDESC .     16 21 XYTAB ." WIDTH =" CMAXX .         27 21 XYTAB ." HEIGHT =" CMAXY .        SMALL-FRAME BEGIN                       KEY DUP 87 =                            IF -1 PUTERVER   ELSE DUP 88 =          IF 1 PUTERVER    ELSE DUP 65 =          IF -1 PUTERHOR   ELSE DUP 68 =          IF 1 PUTERHOR    ELSE DUP 82 =          IF 1 PUT-B-LINE  ELSE DUP 86 =          IF -1 PUT-B-LINE                        THEN THEN THEN THEN THEN THEN            1 21 XYTAB ." DESCENDER =" CDESC .     16 21 XYTAB ." WIDTH =" CMAXX .         27 21 XYTAB ." HEIGHT =" CMAXY .        27 = UNTIL TEXT ;                                                                                                                                                                                                   ( 17:13)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( FIG-EDIT   CONT'D      < 0/ 0/ 0> 99) : +COMMAND                                IF 0 +YDO                               ELSE DUP 63 = IF HELP-SCREEN            ELSE DUP 21 = IF SHIFT-RIGHT            ELSE DUP  8 = IF SHIFT-LEFT             ELSE DUP 62 = IF SHIFT-UP               ELSE DUP 60 = IF SHIFT-DOWN             ELSE BEEP THEN THEN THEN THEN           THEN THEN ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ( 17:13) ( FIG-EDIT   MAIN LOOP   < 0/ 0/ 0>100) : FIG-EDIT BEGIN CLEAR-KBD                 BEGIN CURSE QTERM DUP NOT                IF 10 DELAY THEN UNTIL KEY              DUP 27 = NOT WHILE                            DUP 32 = IF TOGGLE-GRID            ELSE DUP 80 ( P) = IF HOME              ELSE DUP 81 ( Q) = IF -CX-CY            ELSE DUP 67 ( C) = IF +CX+CY            ELSE DUP 69 ( E) = IF +CX-CY            ELSE DUP 90 ( Z) = IF -CX+CY            ELSE DUP 65 ( A) = IF -CX               ELSE DUP 68 ( D) = IF +CX               ELSE DUP 87 ( W) = IF -CY               ELSE DUP 88 ( X) = IF +CY               ELSE DUP 82 ( R) = IF 1 -X-Y            ELSE DUP 89 ( Y) = IF 1 +X-Y            ELSE DUP 78 ( N) = IF 1 +X+Y            ELSE DUP 86 ( V) = IF 1 -X+Y            ELSE DUP 70 ( F) = IF 1 -XDO            ELSE DUP 72 ( H) = IF 1 +XDO            ELSE DUP 66 ( B) = IF 1 +YDO            ELSE DUP 84 ( T) = IF 1 -YDO                  -->                 (  0:00)                                                        ( 17:13) ( FIG-EDIT   CONT'D      < 0/ 0/ 0>101)                                             ELSE DUP 71 ( G) = IF 1 D-IT            ELSE DUP 75 ( K) = IF 0 D-IT            ELSE DUP 85 ( U) = IF 0 -X-Y            ELSE DUP 79 ( O) = IF 0 +X-Y            ELSE DUP 46 ( .) = IF 0 +X+Y            ELSE DUP 77 ( M) = IF 0 -X+Y            ELSE DUP 74 ( J) = IF 0 -XDO            ELSE DUP 76 ( L) = IF 0 +XDO            ELSE DUP 73 ( I) = IF 0 -YDO            ELSE DUP 44 ( ,) =                      +COMMAND                                THEN THEN THEN THEN THEN THEN THEN      THEN THEN THEN THEN THEN THEN THEN      THEN THEN THEN THEN THEN THEN THEN      THEN THEN THEN THEN THEN THEN DROP    2 21 XYTAB ." X=   Y="                  4 21 XYTAB CX @ . 9 21 XYTAB CY @ .     REPEAT DROP ;                           EXIT                                                                                                                                                 (  0:00)                                                        ( 17:13)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( PLIST                  < 0/ 0/ 0>139)                                         : PLIST 1 PR# CR                            1+ SWAP DO I                            CR I BLOCK                              25 0 DO I 2 .R SPACE I 40 * OVER +      40 -TRAILING TYPE CR LOOP               25 40 * + 24 TYPE CR                    5 0 DO CR LOOP LOOP                     0 PR# ;                                                                     : LIST-ALL ( START, END -- )                1+ SWAP DO 0 I BLOCK                    1024 0 DO I OVER + C@ 32 = NOT IF       SWAP 1+ SWAP LEAVE THEN LOOP            DROP IF I I PLIST THEN                  LOOP ;                              ( 2 21   23 50  52 63  65 79 )                                                                                                                                                                                                                                                 (  0:00)                                                                 